<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script src="../script/pinyin4js.js"></script>
    <script>
        var list = [{
            "rongcloud_user_id": "759d2765861e5ba5f4b8e576bfeaee33",
            "user_id": 909,
            "nickname": "成府路13260",
            "head_img_url": "http://img.iinnet.com/FlcfxZr8WXKbW73wfy4tn7LNU-2Z",
            "company_name": "环球壹学（北京）教育科技有限公司",
            "position": "测试"
        }, {
            "rongcloud_user_id": "9b22b1efd52803e8ba186222438484b7",
            "user_id": 102543,
            "nickname": "1861169",
            "head_img_url": "http://img.iinnet.com/FkyGHXeVO8-N9JD69262-4p-gyYv",
            "company_name": "环球壹学（北京）教育科技有限公司",
            "position": "前端"
        }, {
            "rongcloud_user_id": "9b22b1efd52803e8ba186222438484b7",
            "user_id": 102543,
            "nickname": "安慰",
            "head_img_url": "http://img.iinnet.com/FkyGHXeVO8-N9JD69262-4p-gyYv",
            "company_name": "环球壹学（北京）教育科技有限公司",
            "position": "前端"
        }, {
            "rongcloud_user_id": "9b22b1efd52803e8ba186222438484b7",
            "user_id": 102543,
            "nickname": "安1慰",
            "head_img_url": "http://img.iinnet.com/FkyGHXeVO8-N9JD69262-4p-gyYv",
            "company_name": "环球壹学（北京）教育科技有限公司",
            "position": "前端"
        }, {
            "rongcloud_user_id": "9b22b1efd52803e8ba186222438484b7",
            "user_id": 102543,
            "nickname": "播放",
            "head_img_url": "http://img.iinnet.com/FkyGHXeVO8-N9JD69262-4p-gyYv",
            "company_name": "环球壹学（北京）教育科技有限公司",
            "position": "前端"
        }];

        function sortObj(key) {
            return function (val1, val2) {
                var data1 = val1[key]
                var data2 = val2[key]
                if (data1 > data2) {
                    return 1
                } else if (data1 < data2) {
                    return -1
                } else {
                    return 0
                }
            }
        }

        function sqrtData(list) {
            var obj = {}
            list.forEach(function (value) {
                var zimu = PinyinHelper.getShortPinyin(value.nickname).toUpperCase()[0];
                value.letter = /[A-Z]/.test(zimu) ? zimu : '#';
            })
            list = list.sort(sortObj('letter'))
            list.forEach(function (value) {
                if (!obj[value.letter]) {
                    obj[value.letter] = []
                }
                obj[value.letter].push(value)
            })
            return obj
        }

        function SrotList(list) {
            this.list = list;
            this.obj = {};
            this.sortObj = function (key) {
                return function (val1, val2) {
                    var data1 = val1[key]
                    var data2 = val2[key]
                    if (data1 > data2) {
                        return 1
                    } else if (data1 < data2) {
                        return -1
                    } else {
                        return 0
                    }
                }
            }
            this.sqrtData = function () {
                var that = this;
                this.list.forEach(function (value) {
                    var zimu = PinyinHelper.getShortPinyin(value.nickname).toUpperCase()[0];
                    value.letter = /[A-Z]/.test(zimu) ? zimu : '#';
                    value.title = value.nickname
                    value.img = value.head_img_url
                    value.subTitle = value.company_name
                    value.titleSize = 15
                })
                this.list = this.list.sort(this.sortObj('letter'))
                this.list.forEach(function (value) {
                    if (!that.obj[value.letter]) {
                        that.obj[value.letter] = []
                    }
                    that.obj[value.letter].push(value)
                })
                return that.obj
            }
            return this.sqrtData()
        }
        var a = new SrotList(list)
        console.log(a);
                
    </script>
</body>

</html>