



<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <style>
        body,html {
            background-color: #EDECF3;
        }
        .contentText {
            background-color: #fff;
            font-size: .24rem;
            padding: 0 .3rem
        }
        .title {
            height: .9rem;
            border-bottom: 1px solid #CBCBCB;
            line-height: .9rem;
        }
        .smallTitle {
            color: #0ABB07;
        }
        .title input {
            height: .9rem;
            outline: none;
        }
        textarea {
            width: 100%;
            padding: .2rem 0;
            outline: none;
        }

        .addMedia {
            width: 1.6rem;
            height: 1.6rem;
            background: #F8F8F8;
            text-align: center;
            color: #999;
            margin-right: .2rem;
        }   
        .addMedia span{
            display: inline-block;
            height: .9rem;
            width: 100%;
            background: url(../../image/icon_supply/icon_addMedia_01.png)no-repeat;
            -webkit-background-size: .62rem .62rem;
            background-size: .62rem .62rem;
            background-position: bottom center;
            
            margin-bottom: .1rem;
        }
        .addMedia:last-child span {
            background: url(../../image/icon_supply/icon_addMedia_02.png)no-repeat;
            background-size: .6rem .45rem;
            background-position: bottom center;
        }
        .position {
            background: url(../../image/icon_supply/icon_pos.png)no-repeat;
            -webkit-background-size: .26rem .35rem;
            background-size: .26rem .35rem;
            background-position: 0 center;
            height: 1rem;
            line-height: 1rem;
            padding-left: .35rem;
        }



        .classify {
            background-color: #EDECF3;
            font-size: 0;
            
        }
        .classify ul li {
            /*background-color: #fff;*/
            font-size: .24rem;
            height: .8rem;
            line-height: .8rem; 
            width: 100%;
            padding: 0 .3rem 0 .8rem;
            background: #fff url(../../image/icon_my/icon_fb.png)no-repeat;
            -webkit-background-size: .44rem .44rem;
            background-size: .44rem .44rem;
            background-position: .3rem center;
            box-sizing: border-box;
        }
        
        .spanno2 {
            margin-right: .2rem;
            display: inline-block;
            height: .8rem;
            background: url(../../image/icon_zk.png)no-repeat;
            -webkit-background-size: .15rem .25rem;
            background-size: .15rem .25rem;
            background-position: right center;
            float: right;
            color: #BEBEBE;
            padding-right: .3rem;
        }
        li input {
            float: right;
            line-height: .8rem;
            text-align: right;
            padding-right: .5rem;
            font-size: .24rem;
            outline: none;
        }
        .mt20 {
            margin: .2rem 0;
        }
        .mb20 {
            margin-bottom: .2rem;
        }
        

        .btn {
            width: 6.32rem;
            height: .83rem;
            margin: 0 auto;
            border-radius: .1rem;
            background-color: #08BB08;
            font-size: .34rem;
            color: #fff;
            text-align: center; 
            line-height: .83rem;
            margin-top: 1rem;
        }


        ul li:nth-child(1) {
            background: #fff url(../../image/icon_supply/icon_00.png)no-repeat;
            background-size: .28rem .34rem;
            background-position: .3rem center;
        }
        ul li:nth-child(2) {
            background: #fff url(../../image/icon_supply/icon_06.png)no-repeat;
            background-size: .33rem .34rem;
            background-position: .3rem center;
        }
        ul li:nth-child(3) {
            background: #fff url(../../image/icon_supply/icon_12.png)no-repeat;
            background-size: .34rem .33rem;
            background-position: .3rem center;
        }
        .status {
            height: .8rem;
            margin: .2rem 0;
            background-color: #fff;
            font-size: .28rem;
            color: #333;
            line-height: .8rem;
            padding: 0 .3rem 0 .8rem;
            background: #fff url(../../image/icon_supply/icon_13.png)no-repeat;
            background-size: .28rem .31rem;
            background-position: .3rem center;
        }
        .time {
            font-size: .24rem;
            color: #9b9b9b;
        }  
    </style>
</head>
<body>
    <div class="status">
            <span>您的身份</span>
            <span class="spanno2">知情者</span>
        </div>
    <div class="contentText clearfix">
        
        <div class="title">
            <span class="smallTitle">#我提供#</span>
            <input type="text" placeholder="输入您发布的标题" name="">
        </div>
        <textarea placeholder="描述一下您发布的内容" rows="5"></textarea>
        <div class="clearfix">
            <div class="fl addMedia">
                <span></span>
                添加图片
            </div>
            <div class="fl addMedia">
                <span></span>
                添加视频
            </div>
        </div>
        <p class="position" onclick="getPos(this)">北京 北京 海淀区</p>
    </div>
    <div class="classify clearfix">
        <ul>
            <li class="mt20">
                <span>截至时间</span>
                <span class="spanno2"></span>
                <span class="fr">
                     <span class="time">请选择</span>
                     --
                    <span class="time">请选择</span>
                </span>
                
            </li>
            <li onclick="remindWho()">
                <span>提醒谁看</span>
                <span class="spanno2"></span>
            </li>
            <li class="mb20">
                <span>定向投递</span>
                <span class="spanno2"></span>
            </li>
        </ul>        
    </div>
    <div class="btn">发布</div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script type="text/javascript">

    apiready = function(){
        moduleInit();
        
       
        api.addEventListener({
           name: 'selectType'
        }, function(ret, err) {
           if (ret) {
            $api.text($api.dom('._type'), ret.value.selDate);
            if (ret.value.selDate == '公司') {
                $api.css($api.byId('companyName'), 'display: block');
            } else {
                $api.css($api.byId('companyName'), 'display: none');
            }
           } else {
               alert(JSON.stringify(err));
           }
        });
        // 选择类别
        monitorEvent('_genre','_genre');
        monitorEvent('_format','_format');
        monitorEvent('_classify','_classify');
    };

    // 提现谁看
    function remindWho() {
        api.openWin({
            name: 'supply_info_ask_remindWho',
            url: '../supply/supply_info_ask_remindWho.html'
            
        });
    }
    function monitorEvent(eventName, calssName) {
        api.addEventListener({
           name: eventName
        }, function(ret, err) {
           if (ret) {
            $api.text($api.dom('.'+ calssName +''), ret.value.selDate);
           } else {
               alert(JSON.stringify(err));
           }
        });
    }
    // 选择类型  公司 | 个人
    function selectType(ele) {
        var person =  $api.text(ele.getElementsByClassName('spanno2')[0]);

        var _data = $api.attr(ele, 'data-val');
        var flag;
        var _dataSource = [];
        if (_data == '_type') {
            _dataSource = ['个人','公司'];
            flag = 0;
            // var text = $api.text($api.dom('.type1'));
        } else if (_data == '_genre') {
            _dataSource = ['自产自销','代理'];
            flag = 1;
        } else if (_data == '_format') {
            _dataSource = ['线上','线下'];
            flag = 2;
        }else if (_data == '_classify') {
            _dataSource = ['全部','教育','摄影','医疗'];
            flag = 3;
        }
        

        api.openFrame({
                name: '_type',
                url: 'supply_selectType.html',
                rect: {
                    x: 0,
                    y: 0,
                    w: 'auto',
                    h: 'auto'
                },
                pageParam: {
                    dataSource: _dataSource,
                    flag: flag,
                    defaultVal: person
                },
                bounces: false
            });

   }


   // 获取位置
   function getPos(ele) {
        if (api.systemType == 'ios') {
            bMap.initMapSDK(function(ret) {
                if (ret.status) {
                   getLocation();
                } else {
                    alert(JSON.stringify(err))
                }
            });
        } else {
            getLocation();
        }
        
   }
   // 获取经纬度
    function getLocation() {
        bMap.getLocation({
            accuracy: '100m',
            autoStop: true,
            filter: 1
        }, function(ret, err) {
            if (ret.status) {
                alert(JSON.stringify(ret));
                getCoords(ret.lon, ret.lat)
            } else {
                alert(err.code);
            }
        });
    }
    // 根据经纬度获取地址
    function getCoords(lon,lat) {
        bMap.getNameFromCoords({
            lon: lon,
            lat: lat
        }, function(ret, err) {
            if (ret.status) {
                alert(JSON.stringify(ret));
            }
        });
    }
</script>
</html>