<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css" />
    <style type="text/css">
        html {
            height: 100%;
        }
        body {
            position: relative;
            height: 100%;
        }
        .title {
            margin: .2rem 0;
        }

        .title .text {
            font-size: .24rem;
            color: #777;
            margin-right: .2rem;
        }

        .title .line {
            width: .97rem;
            height: .03rem;
            background-color: #999;
        }

        .title .icon {
            width: .284rem;
            height: .34rem;
            /*background-color: #f00;*/
            background: url(../../image/icon_my/icon_myCircle_1.png)no-repeat;
            -webkit-background-size: .284rem .34rem;
            background-size: .284rem .34rem;
            margin-right: .07rem;
            margin-left: .2rem;
        }

        .item {
            height: 1.57rem;
            font-size: 0;
            padding-left: .3rem;
            background-color: #fff;
            margin-top: .01rem;
            padding-bottom: 0.02rem;
        }

        .item .wrap {
            background-color: #fff;
            height: 1.57rem;
            border-bottom: .01rem solid #E6E6E6;
            padding-right: .3rem;
        }
        .complete .item:last-child {
            border-bottom: .01rem solid #E6E6E6;
        }
        .complete .item:last-child .wrap {
            border-bottom: 0
        }
        .item .itemLeft {
            margin-right: .2rem;
        }

        .item img {
            width: .9rem;
            height: .9rem;
        }

        .item h3 {
            font-size: .34rem;
        }

        .item .circleInfo {
            font-size: .28rem;
            color: #999;
        }

        .circleCount {
            margin-top: .12rem;
            font-size: 0;
        }

        .circleCount .no1 {
            margin-right: .6rem;
        }

        .circleCount .label {
            font-size: .24rem;
            color: #999;
        }

        .circleCount .count {
            font-size: .24rem;
            color: #0ABB07;
        }
        .complete {
            background-color: #fff;
        }


        .icon {
            width: 2.2rem;
            height: 2.2rem;
            background: url(../../image/iocn_addressList/icon_noInfo.png)no-repeat;
            -webkit-background-size: 2.2rem 2.2rem;
            background-size: 2.2rem 2.2rem;
            margin: 0 auto;
        }
        .nomain {
            position: absolute;
            top: 0;bottom: 0;left: 0;right: 0;
            margin: auto;
        }
        .hide {
            display: none;
        }
        .nomain p {
            font-size: .3rem;
            color: #999;
            /*width: 3.9rem;*/
            margin: .36rem auto 0;
            text-align: center;
        }
        .nomain .jump {
            color: #89B2EF;
            font-size: 0.34rem;
        }
        .des .icon {
            background: url(../../image/icon_my/icon_myCircle_2.png)no-repeat;
            -webkit-background-size: .284rem .34rem;
            background-size: .284rem .34rem;
        }
    </style>
</head>

<body>
    <div class="main resultList">
       <!-- <div class="wrap">
            <div class="title flex-def flex-cCenter flex-zCenter">
                <span class="line"></span>
                <span class="icon"></span>
                <span class="text">待认证</span>
                <span class="line"></span>
            </div>
            <div class="complete">
                <div class="item">
                    <div class="wrap flex-def flex-cCenter">
                        <div class="itemLeft">
                            <img src="../../image/tx_5.jpg">
                        </div>
                        <div class="itemRight">
                            <h3>UI设计交流</h3>
                            <p class="circleInfo">app及网站设计，圈子里有大牛</p>
                            <div class="circleCount">
                                <span class="label">成员:</span>
                                <span class="count no1">1000</span>
                                <span class="label">发布:</span>
                                <span class="count">1000</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="title flex-def flex-cCenter flex-zCenter">
                <span class="line"></span>
                <span class="icon"></span>
                <span class="text">已创建</span>
                <span class="line"></span>
            </div>
            <div class="complete">
                <div class="item">
                    <div class="wrap flex-def flex-cCenter">
                        <div class="itemLeft">
                            <img src="../../image/tx_5.jpg">
                        </div>
                        <div class="itemRight">
                            <h3>UI设计交流</h3>
                            <p class="circleInfo">app及网站设计，圈子里有大牛</p>
                            <div class="circleCount">
                                <span class="label">成员:</span>
                                <span class="count no1">1000</span>
                                <span class="label">发布:</span>
                                <span class="count">1000</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="item">
                    <div class="wrap flex-def flex-cCenter">
                        <div class="itemLeft">
                            <img src="../../image/tx_5.jpg">
                        </div>
                        <div class="itemRight">
                            <h3>UI设计交流</h3>
                            <p class="circleInfo">app及网站设计，圈子里有大牛</p>
                            <div class="circleCount">
                                <span class="label">成员:</span>
                                <span class="count no1">1000</span>
                                <span class="label">发布:</span>
                                <span class="count">1000</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
       </div> -->
    </div>
    <script type="text/x-dot-template" id="listT">
        <div class="wrap">
            {{?it.verify_waiting_list.length !== 0}}
                <div class="title flex-def flex-cCenter flex-zCenter">
                    <span class="line"></span>
                    <span class="icon"></span>
                    <span class="text">待审核</span>
                    <span class="line"></span>
                </div>
            {{?}}
            <div class="complete">
                {{ for (var i = 0; i < it.verify_waiting_list.length; i++) { }}
                    <div class="item">
                        <div class="wrap flex-def flex-cCenter">
                            <div class="itemLeft">
                                <img src="{{=it.verify_waiting_list[i].image_url}}">
                            </div>
                            <div class="itemRight">
                                <h3>{{=it.verify_waiting_list[i].title}}</h3>
                                <p class="circleInfo">{{=it.verify_waiting_list[i].description}}</p>
                                <div class="circleCount">
                                    <span class="label">成员:</span>
                                    <span class="count no1">{{=it.verify_waiting_list[i].member_count}}</span>
                                    <span class="label">发布:</span>
                                    <span class="count">{{=it.verify_waiting_list[i].topic_count}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                {{ }; }}
            </div>
            {{?it.verify_fail_list.length !== 0}}
            <div class="title flex-def flex-cCenter flex-zCenter">
                <span class="line"></span>
                <span class="icon"></span>
                <span class="text">审核未通过</span>
                <span class="line"></span>
            </div>
        {{?}}
        <div class="complete">
            {{ for (var i = 0; i < it.verify_fail_list.length; i++) { }}
                <div class="item">
                    <div class="wrap flex-def flex-cCenter">
                        <div class="itemLeft">
                            <img src="{{=it.verify_fail_list[i].image_url}}">
                        </div>
                        <div class="itemRight">
                            <h3>{{=it.verify_fail_list[i].title}}</h3>
                            <p class="circleInfo">{{=it.verify_fail_list[i].description}}</p>
                            <div class="circleCount">
                                <span class="label">成员:</span>
                                <span class="count no1">{{=it.verify_fail_list[i].member_count}}</span>
                                <span class="label">发布:</span>
                                <span class="count">{{=it.verify_fail_list[i].topic_count}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            {{ }; }}
        </div>
            {{?it.available_list.length !== 0}}
                <div class="title des flex-def flex-cCenter flex-zCenter">
                    <span class="line"></span>
                    <span class="icon"></span>
                    <span class="text">已创建</span>
                    <span class="line"></span>
                </div>
            {{?}}
            <div class="complete">
                {{ for (var i = 0; i < it.available_list.length; i++) { }}
                <div class="item" tapmode onclick="openCircleInfo(this)" data-name="{{=it.available_list[i].title}}" data-id="{{=it.available_list[i].circle_id}}">
                    <div class="wrap flex-def flex-cCenter">
                        <div class="itemLeft">
                            <img src="{{=it.available_list[i].image_url}}">
                        </div>
                        <div class="itemRight">
                            <h3>{{=it.available_list[i].title}}</h3>
                            <p class="circleInfo">{{=it.available_list[i].description}}</p>
                            <div class="circleCount">
                                <span class="label">成员:</span>
                                <span class="count no1">{{=it.available_list[i].member_count}}</span>
                                <span class="label">发布:</span>
                                <span class="count">{{=it.available_list[i].topic_count}}</span>
                            </div>
                        </div>
                    </div>
                </div>
                {{ }; }}
            </div>
       </div>
    </script>
    <div class="nomain hide flex-def flex-cCenter flex-zCenter">
       <div class="wrap">
            <div class="icon">
        </div>
            <p>空空如也 ~</p>
            <p class="jump" tapmode onclick="openCreateCirclePage()">快去创建圈子吧...</p>
       </div>
    </div>
    <div class="loading "></div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script type="text/javascript" src="../../script/doT.min.js"></script>
<script type="text/javascript">
    apiready = function() {
        // 请求数据
        requireData();
        // 监听创建圈子事件
        foundCircle();
        // 下拉刷新
        api.setCustomRefreshHeaderInfo({
            bgColor: '#EFEFF4',
        }, function(ret, err) {
            requireData();
        })

    };
    // 打开创建圈子页面
    function openCreateCirclePage() {
        api.openWin({
            name: 'winname',
            url: '../find/find_foundCircle_win.html',
            bounces: false,
        });
    }
    // 进入圈子详情
    function openCircleInfo(ele) {
        api.openWin({
            name: 'winName',
            url: '../find/find_dynamicState_win.html',
            pageParam: {
                circle_id: $api.attr(ele, 'data-id'),
                circle_name: $api.attr(ele, 'data-name'),
                flag: 1
            }
        });
    }
    // 监听创建圈子事件
    function foundCircle() {
        api.addEventListener({
            name: 'frame4Open'
        }, function(ret, err) {
            requireData()
        });
        api.addEventListener({
            name: 'circleTopicComment'
        }, function(ret, err){
            requireData()
        });
    }
    function requireData() {
        api.ajax({
            url: apiSite + '/user_center/myCircle',
            method: 'post',
            headers: apiHeader,
            data: {
                   values: {
                       token: $api.getStorage('userToken'),
                   }
            }
        }, function(ret, err) {
            if(ret) {
                //console.log(JSON.stringify(ret))
                // 停止下拉刷新
                api.refreshHeaderLoadDone();
                if (ret.data.verify_waiting_list == '' && ret.data.verify_fail_list == '' && ret.data.available_list == '') {
                     $api.css($api.dom('.main'), 'display:none');
                     $api.css($api.dom('.loading'), 'display:none');
                     $api.removeCls($api.dom('.nomain'), 'hide');
                } else {
                    $api.addCls($api.dom('.nomain'), 'hide');
                    $api.css($api.dom('.loading'), 'display:none');
                    getData(ret.data)
                }
            } else {
                alert(JSON.stringify(err.msg))
            }
        })
    }
</script>

</html>
