<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"><meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../../css/api.css"/>
    <style>
       input {
           border-bottom: .02rem solid #fff;
           width: 100%;
           margin-left: 1rem;
           color: #fff;
           font-size: 0.3rem;
       }
       .nameText {
           font-size: 0.3rem;

       }
       .addressText {
           font-size: 0.24rem;
           color: #999;
       }
       li {
           padding: .1rem .3rem;
            border-bottom: .01rem solid #9d9d9d;
       }
    </style>
</head>
<body>
    <header  class="header">
        <div class="head flex-def flex-cCenter">
                <span class="callback"   tapmode   onclick="api.closeWin()">返回</span>
            <input type="text" id="input" oninput="searchKeyword(this)" placeholder="输入地址">
        </div>
    </header>
    <ul class="resultList"></ul> 
    <script type="text/x-dot-template" id="listT">
        {{~it:value:index}}
        <li>
            <p class="nameText">{{=value.name}}</p>
            <p class="addressText">{{=value.address}}</p>
        </li>
        {{~}}
    </script>
</body>
<script type="text/javascript" src="../../../script/api.js"></script>
<script type="text/javascript" src="../../../script/common.js"></script>
<script type="text/javascript" src="../../../script/doT.min.js"></script>
<script>
    var keyword,dataArr=[],num = 0;
    apiready = function(){
        fnInit();
        moduleInit();
        scrollBottom();
    }
    function scrollBottom() {
        api.addEventListener({
            name: 'scrolltobottom'
        }, function(ret, err){
            searchKeyword2(keyword);
        });
    }
    function searchKeyword(ele) {
        keyword = $api.val(ele);
        searchKeyword2(keyword);
    }
    function searchKeyword2(keyword) {
        bMap.searchInCity({
            city: '北京',
            keyword: keyword,
            pageIndex: num,
            pageCapacity: 20//1~50
        }, function(ret,err){
            if(ret.status){
                num = ret.pageIndex + 1;
                dataArr = dataArr.concat(ret.results);
                getData(dataArr);
            }else{
                alert(JSON.stringify(err));
            }
        });
    }
        
</script>
</html>