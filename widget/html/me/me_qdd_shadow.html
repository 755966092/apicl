<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"><meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <style>
        html, body {
            height: 100%;
            width: 7.5rem;
            background-color: rgba(0,0,0,0.2);
        }
        .main {
            width: 100%;
            height: 100%;
        }
        .slide {
            width: 6rem;
            height: 100%;
            margin-left: 1.5rem;
            background-color: #fff;
            font-size: 0;
            box-sizing: border-box;
            position: relative;
        }
        .wrap {
             padding: .4rem 0  0 .2rem;
        }
        .slide .status {
            padding-right: .2rem;
            padding-bottom: .2rem;
            margin-bottom: .3rem;
        }
        .bb {
            border-bottom: .01rem solid #ECECEC;
        }
        .slide p {
            font-size: .24rem;
            color: #555;
            margin-bottom: .15rem;
        }
        .slide span {
            margin-right: .13rem;
            width: 1.78rem;
            font-size: .24rem;
            background-color: #F3F3F3;
            border-radius: .1rem;
            height: .8rem;
            text-align: center;
            line-height: .8rem;
            margin-bottom: .2rem;
        }
        .sel {
            background: #f3f3f3 url(../../image/icon_supply/icon_text4.png)no-repeat;
            -webkit-background-size: 1.78rem .8rem;
            background-size: 1.78rem .8rem;
        }
        .slide span.mr0 {
            margin-right: 0;
        }
        .footer {
            height: .78rem;
            width: 100%;
            font-size: 0;
            line-height: .78rem;
            position: absolute;
            bottom: 0;right: 0;
        }
        .footer span {
            border-radius: 0;
            margin: 0;
            width: 50%;
            text-align: center;
            font-size: .34rem;
            position: absolute;
            bottom: 0;
        }
        .footer span:last-child{
            right: 0;
            bottom: 0;
            color: #fff;
            background-color: #27B24A;
        }
    </style>
</head>
<body>
     <div class="main" ontouchstart="api.closeFrame()">
        <div class="slide" ontouchstart = 'event.stopPropagation();'>
            <div class="wrap">
                <div class="status no1 bb">
                    <p>状态</p>
                    <span data-val="" ontouchstart="selClass(this)" class="sel flag">全部状态</span>
                    <span data-val="1" ontouchstart="selClass(this)">待付款</span>
                    <span data-val="3,5" ontouchstart="selClass(this)" class="mr0">待完成</span>
                    <span data-val="6,7,11" ontouchstart="selClass(this)">已完成</span>
                    <span data-val="2,4,8,9,10" ontouchstart="selClass(this)">已取消</span>
                </div>
                <div class="status no2 bb">
                    <p>类型</p>
                    <span data-val="" ontouchstart="selClass(this)" class="sel flag">全部类型</span>
                    <span data-val="1" ontouchstart="selClass(this)">个人</span>
                    <span data-val="2" ontouchstart="selClass(this)" class="mr0">公司</span>
                </div>
               <!--  <div class="status no3">
                    <p>分类</p>
                    <span data-val="" ontouchstart="selClass(this)" class="sel flag">全部分类</span>
                    <span data-val="1" ontouchstart="selClass(this)">自产自销</span>
                    <span data-val="2" ontouchstart="selClass(this)" class="mr0">代理代销</span>
                </div> -->
            </div>
             <div class="footer">
                    <span ontouchstart="enter(0)">重置</span>
                    <span ontouchstart="enter(1)">确定</span>
            </div>
        </div>
     </div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script type="text/javascript">
    apiready = function(){
        // 保持按钮选择的内容
        keepBtn()
    };
    // 保持上次选中的按钮
    function keepBtn() {
        var node = $api.domAll('span');
            for (var i = 0; i < node.length; i++) {
                $api.removeCls(node[i], 'sel');
            }
            $api.addCls($api.dom('.no1 span[data-val="'+ api.pageParam.status +'"]'), 'sel');
            $api.addCls($api.dom('.no2 span[data-val="'+ api.pageParam.type +'"]'), 'sel');
            $api.addCls($api.dom('.no3 span[data-val="'+ api.pageParam.sub_type +'"]'), 'sel');
    }
    function selClass(ele) {
        var node = $api.not($api.closest(ele, '.status'), 'p')
        for (var i = 0; i < node.length; i++) {
            $api.removeCls(node[i], 'sel');
        }
        $api.addCls(ele, 'sel');
    }
    function enter(n) {
        if (n) {
            var type,sub_type,status
            // 确定
            for (var i = 0; i < $api.domAll('.sel').length; i++) {
                status = $api.attr($api.domAll('.sel')[0], 'data-val');
                type = $api.attr($api.domAll('.sel')[1], 'data-val');
                sub_type = $api.attr($api.domAll('.sel')[2], 'data-val');
            }
            // alert(status+'--'+type+'--'+sub_type)
            api.sendEvent({
                name: 'filterOrder',
                extra: {
                    status: status, 
                    type: type, 
                    sub_type: sub_type
                }
            });
            setTimeout(function() {
                api.closeFrame();
            },500)
        } else {
            // 重置
            var node = $api.domAll('span');
            for (var i = 0; i < node.length; i++) {
                $api.removeCls(node[i], 'sel');
            }
            var flag = $api.domAll('.flag');
            for (var i = 0; i < flag.length; i++) {
                $api.addCls(flag[i], 'sel');
            }
        }
    }
    // 1-买家待付款，1
        // 待完成 3,4,6
        // 已完成 7,8,15
        // 已取消 2,10,12,13,14,16
    // 
    // 
    // 
    // 2-买家取消付款，
    // 3-等待卖家接单，
    // 4-待确认服务，
    // 5-卖家拒绝接单，
    // 6-卖家等待买家确认完成，
    // 7-卖家确认完成服务，
    // 8-买家确认完成服务，
    // 9-买家等待卖家确认取消订单，
    // 10-买家取消订单，
    // 11-卖家拒绝取消订单，
    // 12-卖家取消订单，
    // 13-系统取消未付款订单，
    // 14-系统取消未接单服务，
    // 15-系统完成服务，
    // 16-系统取消服务
</script>
</html>