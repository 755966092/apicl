<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"><meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <style>
        body{
            background-color: rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script type="text/javascript">
    apiready = function(){
    	var headerH = api.pageParam.headerH;
        var FNScanner = api.require('FNScanner');
    	
    	api.addEventListener({
		    name:'viewappear'
		}, function(ret, err){        
		   openPage();
		});
    	api.addEventListener({
		    name: 'keyback'
		}, function(ret, err) {
		    FNScanner.closeView();
    	    api.closeWin();
		});
    	api.addEventListener({
    	    name: 'closeView'
    	}, function(ret, err) {
    	    if (ret) {
    	    	FNScanner.closeView();
    	        api.closeWin();

    	    } else {
    	        alert(JSON.stringify(err));
    	    }
    	});
	    FNScanner.openView({
	    	rect: {
	    		x: 0,
	    		y: headerH,
	    		
	    	},
		    autorotation: true
		}, function(ret, err) {
		    if (ret) {
		    	
		    	if (ret.eventType == 'show') {
		    		openPage();
		    	}
				if (ret.eventType == 'success') {
		    		openUserPage(parseURL(ret.content).params.inappuid)
				}
		    } else {
		        alert(JSON.stringify(err.msg));
		    }
		});

    };
    function openUserPage(id) {
    	api.openWin({
    	    name: 'winName',
    	    url: '../addressList/txl_memberInfo_Win.html',
    	    pageParam: {
    	        userId: id
    	    }
    	});
    }
    function openPage() {
    	api.openFrame({
		    name: 'frameName',
		    url: './erweimaShade.html',
		    rect: {
		        x: 0,
		        y: api.pageParam.headerH,
		        // w: api.frameWidth,
		        w: api.frameWidth,
		        h: api.frameHeight
		    },
		     pageParam: {
		        name: api.frameHeight
		    },
		    bounces: false
		});
    }
    // 解析url
     function parseURL(url) {
            var a = document.createElement('a');
            a.href = url;
            return {
                source: url,
                protocol: a.protocol.replace(':', ''),
                host: a.hostname,
                port: a.port,
                query: a.search,
                params: (function () {
                    var ret = {},
                        seg = a.search.replace(/^\?/, '').split('&'),
                        len = seg.length, i = 0, s;
                    for (; i < len; i++) {
                        if (!seg[i]) { continue; }
                        s = seg[i].split('=');
                        ret[s[0]] = s[1];
                    }
                    return ret;
                })(),
                file: (a.pathname.match(/\/([^\/?#]+)$/i) || [, ''])[1],
                hash: a.hash.replace('#', ''),
                path: a.pathname.replace(/^([^\/])/, '/$1'),
                relative: (a.href.match(/tps?:\/\/[^\/]+(.+)/) || [, ''])[1],
                segments: a.pathname.replace(/^\//, '').split('/')
            };
        }
</script>
</html>