<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"><meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <style>
        body,html {
            width: 100%;
        }
        .main {
            font-size: 0;
            width: 100%;
        }
        .ipt {
            width: 100%;
            background-color: #EFEFF4;
            font-size: 0;
            padding: .15rem .15rem;
            box-sizing: border-box;
        }
        .ipt input {
            font-size: .24rem;
            width: 100%;
            height: .503rem;
            outline: none;
            background: #fff url(../../image/icon_supply/icon_search.png)no-repeat;
            -webkit-background-size: .25rem .26rem;
            background-size: .25rem .26rem;
            background-position: .15rem center;
            border: .01rem solid #DDDEE2;
            padding-left: .5rem;
            box-sizing: border-box;
            padding-right: 0.1rem;
        }
        /*input::-webkit-input-placeholder{
            text-align: center;
        }*/
        .hisSearch {
            font-size: 0;
        }
        .hisSearch .title {
            height: .65rem;
            padding: 0 .3rem;
            font-size: .28rem;
            color: #333;
            line-height: .65rem;
            float: left;
            width: 100%;
            box-sizing: border-box;
        }
        .hisSearch .delIcon {
            display: inline-block;
            width: .25rem;
            height: .65rem;
            background: url(../../image/icon_other/icon_delet.png)no-repeat;
            -webkit-background-size: .25rem .28rem;
            background-size: .25rem .28rem;
            background-position: 0 center;
            float: right;
        }
        .hisSearchContent {
            padding: 0 .3rem;
            font-size: 0;
        }
        .hisSearchContent .hisSearchItem {
            font-size: .24rem;
            line-height: .52rem;
            padding: 0 .24rem;
            background-color: #fff;
            margin-right: .2rem;
            margin-bottom: .2rem;
        }

        .allSearch {
            font-size: 0;
            margin-top: .4rem;
        }
        .allSearch .title2 {
            font-size: .3rem;
            line-height: .4rem;
            text-align: center;
        }
        .allSearch ul {
            width: 100%;
            box-sizing: border-box;
            padding: 0 .3rem;
        }
        .allSearch ul li {
            font-size: .28rem;
            color: #0ABB07;
            letter-spacing: .078rem;
            width: 33.3%;
            box-sizing: border-box;
            border-right: .01rem solid #d9d9d9;
            float: left;
            text-align: center;
            line-height: .4rem;
            margin-top: .5rem;
            padding: 0 .1rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .allSearch ul li:nth-child(3n) {
            border: 0;
        }
        .filter {
            width: .64rem;
            height: .5rem;
            background: url(../../image/icon_supply/icon_sx.png)no-repeat;
            -webkit-background-size: .35rem .35rem;
            background-size: .35rem .35rem;
            background-position: center center;
            /* margin-left: .1rem; */
            float: right;
        }
        form {
            position: relative;
            padding-right: .7rem;
        }
        .filter {
            position: absolute;
            right: 0;
            top: 0;
        }
    </style>
</head>
<body>
    <div class="main">
        <div class="ipt">
            <form>
                <!-- <input type="search" name="" id="ipt" placeholder="搜索"> -->
                <input type="search" id="input"  placeholder="搜索">
                <span class="filter" tapmode onclick="openFilter()"></span>
            </form>
        </div>
    </div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script type="text/javascript" src="../../script/doT.min.js"></script>

<script type="text/javascript">
    var data = [],parameter,selectedObj,type;
    apiready = function(){
        // getData(data);
        //console.log('参数::'+JSON.stringify(api.pageParam))
        bindEvent();
        // 点击搜索收起键盘
        hideKeyboard();
        api.addEventListener({
            name: 'searchSupply3'
        }, function(ret, err) {
            if (ret) {
                // alert(JSON.stringify(ret));
                parameter = ret.value.parameter
                api.pageParam.typePage = ret.value.type
                selectedObj = ret.value.selectedObj
            } else {
                // alert(JSON.stringify(err));
            }
        });
    };
    $api.dom('form').onsubmit = function() {
        return false;
    };
    function bindEvent() {
            if (api.systemType == 'ios') {
                $api.addEvt($api.byId('input'), 'compositionend', function() {
                // $('#input').on("compositionend", function () {
                    changeInput(this);
                })
            } else {
                $api.addEvt($api.byId('input'), 'input', function () {
                // $('#input').on("input", function () {
                    changeInput(this);
                })
            }
        }
    function changeInput(ele) {
            var iputText = $api.val(ele);
            // if (e.keyCode == 13) {
            // data.push(iputText);
            if (iputText) {
                api.openFrame({
                    name: 'supply_searchSupplyFruit_frame',
                    url: './supply_searchSupplyFruit_frame.html',
                    rect: {
                        x: 0,
                        y: api.pageParam.headerH + $api.offset($api.dom('.ipt')).h,
                        w: 'auto',
                        h: 'auto'
                    },
                    pageParam: {
                        keyword: iputText,
                        typePage: api.pageParam.typePage,
                    },
                    bounces: true
                });
                api.sendEvent({
                    name: 'searchSupply2',
                    extra: {
                        keyword: iputText
                    }
                });
            } else {
                api.closeFrame({
                    name: 'supply_searchSupplyFruit_frame'
                });
            }
            // }

            // }
            // if (iputText == '') {
                // api.closeFrame({
                //     name: 'supply_searchSupplyFruit_frame'
                // });
            // }
    }
    function hideKeyboard() {
        $api.addEvt($api.dom('input'), 'keyup', function (e) {
            if (e.keyCode === 13) {
                document.getElementsByTagName('input')[0].blur()
            }
        });
    }
    function openFilter() {
      //  console.log(JSON.stringify(api.pageParam,null,4))
        $api.dom('input').blur();
        api.openFrame({
            name: 'supply_slideFrame_3',
            url: './supply_slideFrame_3.html',
            rect: {
                x: 0,
                y: 0,
                w: 'auto',
                h: 'auto'
            },
            pageParam: {
                type: api.pageParam.typePage,
                parameter: parameter,
                selectedObj: selectedObj,
            },
            bounces: false
        });
    }
   
</script>
</html>