<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="format-detection" content="telephone=no"/>
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <style>
        .title {
            margin-top: .37rem;
            border-top: .01rem solid #E4E4E4;
            border-bottom: .01rem solid #E4E4E4;
            background-color: #fff;
            height: 1.54rem;
            font-size: 0;
            padding: 0 .3rem;
            display: -webkit-box;
            display: flex;
            -webkit-box-align: center;
            align-items: center;
        }

        .headImg {
            margin-right: .2rem;
        }

        .title img {
            width: .91rem;
            height: .91rem;
            border-radius: .1rem;
        }

        .title p,
        .titleRight p {
            font-size: .22rem;
            color: #999;
        }

        .titleRight {
            /* display: -webkit-box;
             display: flex;
             -webkit-box-align: start ;
             align-items: flex-start;
              -webkit-box-direction: normal;
              flex-direction: column;*/
            width: 6rem;
        }

        .titleRight {
            font-size: .24rem;
        }

        .titleRight .name {
            height: .3rem;
            font-size: 0;
            width: 100%;
            display: -webkit-box;
            display: flex;
            -webkit-box-align: center;
            align-items: center;
            -webkit-box-pack: justify;
            justify-content: space-between;
            /*margin-bottom: .1rem;*/
        }

        .titleRight .name h3 {
            font-size: .3rem;
            line-height: .42rem;
            margin-right: .03rem;
        }

        .titleRight .sexIcon {
            margin-left: .2rem;
            width: .21rem;
            height: .21rem;
            background: url(../../image/icon_my/icon_my01.png) no-repeat;
            -webkit-background-size: .21rem .21rem;
            background-size: .21rem .21rem;
            /*float: left;*/

        }

        .titleRight .sexIcon2 {
            background: url(../../image/icon_my/icon_my02.png) no-repeat;
            -webkit-background-size: .21rem .21rem;
            background-size: .21rem .21rem;
        }

        .company {
            margin-top: .1rem;
            display: -webkit-box;
            display: flex;
            -webkit-box-align: center;
            align-items: center;
            width: 100%;
            -webkit-box-pack: justify;
            justify-content: space-between;
            position: relative;
        }

        .company p {
            font-size: .24em;
        }

        .company .companyName {
            margin-bottom: .1rem;
            font-size: .24rem;
            color: #555;
            line-height: .33rem;
            /*letter-spacing: -.026rem;*/

        }

        .company .companyArrow {
            position: absolute;
            right: 0;
            top: .1rem;
            width: .14rem;
            /*height: .23rem;*/
            background: url(../../image/icon_zk.png) no-repeat;
            -webkit-background-size: . ` 14rem .23rem;
            background-size: .14rem .23rem;
            background-position: 0 bottom;
        }

        .wran {
            text-align: center;
            font-size: .24rem;
            line-height: .5rem;
            color: #9b9b9b;
            margin-top: .05rem;
        }

        .business {
            margin-top: .37rem;
            height: 1.2rem;
            font-size: 0;
            display: -webkit-box;
            display: flex;
            background-color: #fff;
            width: 100%;
        }

        .business > div {
            width: 33.3%;
            line-height: .7rem;
            text-align: center;
            font-size: .28rem;
            color: #333;
            box-sizing: border-box;

        }

        .business .supplyIcon {
            display: inline-block;
            width: .44rem;
            height: .7rem;
            background: url(../../image/icon_my/icon_gdd.png) no-repeat;
            -webkit-background-size: .42rem .41em;
            background-size: .42rem .41rem;
            background-position: 0 center;
            vertical-align: bottom;
            margin-right: .1rem;

        }

        .business p {
            line-height: .4rem;
            font-size: .24rem;
            color: #555;
        }



        .ask > div {
            position: absolute;
            width: 33.33%;
            margin-top: .18rem;
            height: .8rem;
            border-right: .01rem solid #D8D8D8;
            border-left: .01rem solid #D8D8D8;
        }

        .business .askIcon {
            display: inline-block;
            width: .44rem;
            height: .7rem;
            background: url(../../image/icon_my/icon_qdd.png) no-repeat;
            background-size: .48rem .35rem;
            background-position: 0 center;
            vertical-align: bottom;
            margin-right: .1rem;
        }

        .business .circleIcon {
            display: inline-block;
            width: .44rem;
            height: .7rem;
            background: url(../../image/icon_my/icon_wdq.png) no-repeat;
            -webkit-background-size: .42rem .42rem;
            background-size: .42rem .42rem;
            background-position: 0 center;
            vertical-align: bottom;
            margin-right: .1rem;
        }

        .mt20 {
            margin-top: .36rem;
            padding-right: 0;
            border-bottom: 0;
        }

        .wrap1 {
            padding-right: 0;
            border-bottom: 0;
        }

        .wrap {
            border-bottom: .01rem solid #d9d9d9;
            box-sizing: border-box;
            height: .8rem;
            padding-right: .3rem;
        }

        ul li {
            line-height: .8rem;
            height: .8rem;
            font-size: 0;
            padding: 0 .3rem;
            background-color: #fff;
            border-bottom: .01rem solid #d9d9d9;
        }

        ul li span {
            font-size: .28rem;
            color: #333;
            max-width: 5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        ul li .icon {
            display: inline-block;
            width: .15rem;
            height: .8rem;
            background: url(../../image/icon_zk.png) no-repeat;
            -webkit-background-size: .15rem .25rem;
            background-size: .15rem .25rem;
            background-position: 0 center;
            float: right;
        }
        .title .icon {
            display: inline-block;
            width: .15rem;
            height: .8rem;
            background: url(../../image/icon_zk.png) no-repeat;
            -webkit-background-size: .15rem .25rem;
            background-size: .15rem .25rem;
            background-position: 0 center;
            float: right;
        }
        ul li .liRight {

        }
        .status .iconStatus {
            display: inline-block;
            width: .44rem;
            height: .8rem;
            float: right;
        }
        .status .sel {
            background: url(../../image/icon_my/icon_enter.png)no-repeat;
            -webkit-background-size: .44rem .35rem;
            background-size: .44rem .35rem;
            background-position: center center;
        }

        ul li .liRightIcon {
            float: right;
            display: inline-block;
            /*background: url(../../image/tx_4.jpg);*/
            width: .749rem;
            height: .458rem;
            -webkit-background-size: .749rem auto;
            background-size: .749rem auto;
            background-position: 0 center;
            margin-top: .17rem;
            margin-right: .2rem;

        }

        ul li img {
            margin-top: .17rem;
            width: .749rem;
            height: .458rem;
        }

        .btn {
            width: 6.785rem;
            height: .841rem;
            border-radius: .06rem;
            background-color: #1AAD19;
            border: .01rem solid #189c17;
            margin: 0 auto;
            line-height: .841rem;
            text-align: center;
            font-size: .34rem;
            color: #fff;
            margin-top: .36rem;
            margin-bottom: .2rem;
            display: none;
        }

        .activeTime {
            font-size: .22rem;
            position: relative;
        }

       /* .shadow {
            width: .56rem;
            height: .3rem;
            background: url(../../image/icon_txl/icon_shadow.png) no-repeat;
            -webkit-background-size: .56rem .3rem;
            background-size: .56rem .3rem;
            position: absolute;
            top: 0;
            left: 0;

        }*/

        .nameNo1 {
            display: -webkit-box;
            display: flex;
            -webkit-box-align: center;
            align-items: center;
        }
        .shadow {
            /*display: none;*/
            background-color: #f00;
            position: fixed;
            top: 0;
            left: 0;
            width: 7.5rem;
            /*height: 12rem;*/
            opacity: 0;
            display: none;
        }
    </style>
</head>
<body>
<!-- <p class="wran">加入会员后可查看对方最近一次活跃时间</p> -->
<div class="main">
    <div class="title flex-def flex-cCenter" tapmode onclick="openInfo(this)" data-val="details">
        <div class="headImg">
            <img id="head_img_url" src="../../image/icon_defaultHead.png">
        </div>
        <div class="titleRight flex-def flex-zTopBottom">
            <div class="name">
                <div class="nameNo1">
                    <h3 id="nickname"></h3>
                    <span id="sex" class="sexIcon"></span>
                </div>
                <!--   <div class="activeTime">
                      <span class="shadow"></span>
                      1天前活跃
                  </div> -->
            </div>
            <div class="company ">
                <span class="companyName">
                    <span id="current_company"></span>
                    <span id="current_position"></span>
                    <span id="current_degree"></span>
                </span>
            </div>
            <!-- <p>加入会员后可查看对方最近一次活跃时间</p> -->
        </div>
        <span class="icon"></span>
    </div>
    <!--<div class="business">
        <div class="supply">
            <span class="supplyIcon"></span>
            <p class="text">供订单</p>
        </div>
        <div class="ask">
            <div></div>
            <span class="askIcon"></span>
            <p class="text">求订单</p>

        </div>
        <div class="circle">
            <span class="circleIcon"></span>
            <p class="text">参与的圈</p>
        </div>
    </div>-->
    <ul class="mt20">
        <!-- <li tapmode onclick="openInfo(this)" data-val="friendContact"> -->
        <li  data-val="friendContact">
            <span id="relationship_level"></span>
            <!-- <span class="icon"></span> -->
        </li>
        <li class="mt20" tapmode onclick="openInfo(this)" data-val="mainPhone">
            <div class="wrap">
                <span>电话：</span>
                <span id="phone"></span>
                <span class="icon"></span>
            </div>
        </li>
        <li tapmode class="wrap1" onclick="openInfo(this)" data-val="otherContact">
            <div class="wrap">
                <span>其他联系方式</span>
                <span class="icon"></span>
            </div>
        </li>
        <li tapmode class="wrap1" onclick="openInfo(this)" data-val="address">
           <div class="wrap">
                <span>地址</span>
                <span class="icon"></span>
           </div>
        </li>
        <li tapmode onclick="openInfo(this)" data-val="label">
            <span>备注</span>
            <span class="icon"></span>
            <!-- <img class="liRight" src="../../image/tx_4.jpg"> -->
            <span class="liRightIcon" id="liRightIcon"></span>
        </li>
    </ul>
    <ul class="status mt20 resultList"></ul>
        <script type="text/x-dot-template" id="listT">
            {{?it}}
                {{ for (var i = 0; i < it.length; i++) { }}
                    {{?it[i].type == 1}}
                        <li tapmode data-statusId = '{{=it[i].status_id}}' data-type = '{{=it[i].type}}' onclick="selCurrentStatus(this)">
                            <span class="statusText">{{=it[i].name}} {{=it[i].position}}</span>
                            {{?it[i].is_default==1}}
                            <span class="iconStatus sel"></span>
                            {{??}}
                            <span class="iconStatus "></span>
                            {{?}}
                        </li>
                    {{??}}
                        <li tapmode data-statusId = '{{=it[i].status_id}}' data-type = '{{=it[i].type}}' onclick="selCurrentStatus(this)">
                            <span class="statusText">{{=it[i].name}} {{=it[i].position}}
                            {{?it[i].degree==0}}
                            {{??it[i].degree==1}}
                            专科
                            {{??it[i].degree==2}}
                            本科
                            {{??it[i].degree==3}}
                            硕士
                            {{??it[i].degree==4}}
                                博士
                            {{??it[i].degree==5}}
                               博士后
                            {{??}}
                                {{=it[i].degree}}
                            {{?}}
                            </span>
                            {{?it[i].is_default==1}}
                            <span class="iconStatus sel"></span>
                            {{??}}
                            <span class="iconStatus "></span>
                            {{?}}
                        </li>
                    {{?}}
                {{ }; }}
            {{??}}
            {{?}}
        </script>

      <!--   <li>
            <span>中央财经大学 工商管理 硕士</span>
            <span class="iconStatus sel"></span>
        </li>
    </ul>-->
    <ul>
        <li class="mt20" tapmode onclick="openInfo(this)" data-val="study">
            <div class="wrap">
                <span>学习经历</span>
                <span class="icon"></span>
            </div>
        </li>
        <li tapmode class="wrap1" onclick="openInfo(this)" data-val="workExper">
            <div class="wrap">
                <span>工作经历</span>
                <span class="icon"></span>
            </div>
        </li>
        <li onclick="openInfo(this)" data-val="project">
            <span>项目业绩</span>
            <span class="icon"></span>
        </li>
        <li class="mt20" tapmode onclick="selectList()">
            <div class="wrap">
                <span>家乡：</span>
                <span id="hometown"></span>
                <span class="icon"></span>
            </div>
        </li>
        <li tapmode onclick="openTime()">
            <span>生日：</span>
            <span id="birthday"></span>
            <span class="icon"></span>
        </li>
    </ul>

    <div class="btn" id="btn" tapmode onclick="addFriends(this)">发送消息</div>
</div>
<div class="shadow"></div>
</body>
<script type="text/javascript" src="../../script/api.js"></script>
<script type="text/javascript" src="../../script/common.js"></script>
<script type="text/javascript" src="../../script/doT.min.js"></script>
<script type="text/javascript" src="../../data/city_3.js"></script>
<script type="text/javascript">
    var paramNickname, paramRealName, paramSex, paramHeadImg,relationship_level_flag;
    var SQLName = 'db_' + $api.getStorage('userToken');
    var targetRongId;
    apiready = function () {
        $api.css($api.dom('.shadow'), 'height:'+$api.offset($api.dom('.main')).h+'px;');
        // // // console.log('484:::'+JSON.stringify(api.pageParam))
        if(api.pageParam.userId == 0) {
            console.log(JSON.stringify(api.pageParam))
            // 进入自己的详情页
            api.ajax({
                url: apiSite + '/user/detail',
                method: 'post',
                headers: apiHeader,
                data: {
                    values: {
                        token: $api.getStorage('userToken'),
                    }
                }
            }, function(ret, err) {
                if(ret) {
                    // // // console.log('499:::'+JSON.stringify(ret))
                    api.pageParam.userId = ret.data.info.user_id;
                    moduleInit();
                    console.log('540')
                    initPage();
                    initStatus();
                } else {
                    alert(JSON.stringify(err))
                }
            })
        } else {
            moduleInit();
            console.log('549')
            initPage();
            initStatus();
        }


        // requireDetailData();
        api.addEventListener({
            name: 'editUserInfo'
        }, function (ret, err) {
            if (ret) {
                console.log('监听到事件')
                initPage();
            } else {
                alert(JSON.stringify(err));
            }
        });
    };
    // 备注当前状态
    function selCurrentStatus(ele) {
        var type = $api.attr(ele, 'data-type'), status_id= $api.attr(ele, 'data-statusId');
        api.ajax({
            url: apiSite + '/remark_user/setDefaultStatus',
            method: 'post',
            headers: apiHeader,
            data: {
                   values: {
                       token: $api.getStorage('userToken'),
                       remark_user_id: api.pageParam.userId,
                       type: type,
                       status_id: status_id
                   }
            }
        }, function(ret, err) {
            if(ret) {
                if (ret.code == 200) {
                    for (var i = 0; i < $api.domAll('.iconStatus').length; i++) {
                        $api.removeCls($api.domAll('.iconStatus')[i], 'sel');
                    };
                    $api.addCls($api.dom(ele, '.iconStatus'), 'sel');
                    $api.text($api.byId('current_company'), $api.text($api.dom(ele, '.statusText')));
                    // $api.text($api.byId('current_company'), $api.text($api.dom(ele, '.statusText')));
                    // $api.text($api.byId('current_company'), $api.text($api.dom(ele, '.statusText')));
                    // // alert(JSON.stringify(ret))
                    // // // console.log('修改当前状态成功')
                    // 更新数据库
                    updateStatusSql(status_id,ele)
                } else {
                    alert(ret.msg)
                }
            } else {
                alert(JSON.stringify(err))
            }
        })
    }
    // 更新数据库
    function updateStatusSql(status_id, ele) {
        db.executeSql({
            name: SQLName,
            sql: ' UPDATE tb_remarks_status SET is_default = '+ -1
        }, function(ret, err){
            if( ret.status ){
                db.executeSql({
                    name: SQLName,
                    sql: ' UPDATE tb_remarks_status SET is_default = '+ 1 +' WHERE status_id = ' + status_id
                }, function(ret, err){
                    if( ret.status ){
                        // alert( JSON.stringify( ret ) );
                        // // // console.log('更新成功')
                        // initStatus();
                        // reviseText()

                    }else{
                        alert( JSON.stringify( err ) );
                    }
                });
            }else{
                alert( JSON.stringify( err ) );
            }
        });
        console.log($api.text($api.dom(ele, '.statusText')))
        // 更新列表数据库
        db.executeSql({
            name: SQLName,
            sql: ' UPDATE addressList_simplify SET subTitle = "'+ $api.text($api.dom(ele, '.statusText'))+'" WHERE user_id =' + api.pageParam.userId
        }, function(ret, err){
            if( ret.status ){
                console.log('执行成功')
              api.sendEvent({
                  name: 'editUserInfoUpdateList'
              });
            }else{
                alert( JSON.stringify( err ) );
            }
        });

    }
    // 获取会员信息
    function requireData(flag,data) {
        console.log('执行了')
        var current_company = $api.byId('current_company');
        var current_position = $api.byId('current_position');
        var current_degree = $api.byId('current_degree');
        var phone = $api.byId('phone');
        var hometown = $api.byId('hometown');
        var birthday = $api.byId('birthday');
        var nickname = $api.byId('nickname');
        var sex = $api.byId('sex');
        var head_img_url = $api.byId('head_img_url');
        api.ajax({
            // url: apiSite + '/user/detail',
            url: apiSite + '/remark_user/fullInfo',
            method: 'post',
            headers: apiHeader,
            data: {
                values: {
                    token: $api.getStorage('userToken'),
                    remark_user_id: api.pageParam.userId
                }
            }
        }, function (ret, err) {
            if (ret) {
                if (ret.code == 200) {
                    // // // console.log('获取线上备注信息:::'+JSON.stringify(ret))
                    // infoComparison(data, ret.data.info)
                    api.ajax({
                        url: apiSite + '/user/detail',
                        method: 'post',
                        headers: apiHeader,
                        data: {
                               values: {
                                   token: $api.getStorage('userToken'),
                                   user_id: api.pageParam.userId
                               }
                        }
                    }, function(retDetail, errDetail) {
                        if(retDetail) {
                            // console.log('数据库信息:::'+JSON.stringify(data))
                            infoComparison(data,retDetail.data.info);
                            infoComparison2(ret.data.info,retDetail.data.info);
                            relationship_level_flag = retDetail.data.relationship_level;
                            targetRongId = retDetail.data.info.rongcloud_user_id;
                            if (flag) {
                                // 无本地信息, 网络获取
                                relationship(retDetail.data.relationship_level,retDetail.data.info.status)
                                // 真实姓名
                                if (ret.data.info.real_name) {
                                    paramRealName = ret.data.info.real_name;
                                } else {
                                    paramRealName = retDetail.data.info.real_name;
                                }
                                // 昵称
                                if (ret.data.info.nickname) {
                                    $api.text(nickname, ret.data.info.nickname);
                                } else {
                                    $api.text(nickname, retDetail.data.info.nickname);
                                }

                                // 头像
                                if (ret.data.info.head_img_url) {
                                    $api.attr(head_img_url, 'src', ret.data.info.head_img_url);
                                } else {
                                    $api.attr(head_img_url, 'src', retDetail.data.info.head_img_url);
                                }
                                // 性别
                                if (ret.data.info.sex) {
                                    if (ret.data.info.sex == 2) {
                                        $api.addCls(sex, 'sexIcon2');
                                    }
                                } else {
                                    if (retDetail.data.info.sex == 2) {
                                        $api.addCls(sex, 'sexIcon2');
                                    }
                                }
                                var companyStr ='';
                                 // 当前公司
                                if (ret.data.info.current_company) {
                                    companyStr += (ret.data.info.current_company || '') + ' '
                                    // $api.text(current_company, ret.data.info.current_company || '');
                                } else {
                                    companyStr += (retDetail.data.info.current_company || '') + ' '
                                    // $api.text(current_company, retDetail.data.info.current_company || '');
                                }
                                // 当前职位
                                if (ret.data.info.current_position) {
                                    // $api.text(current_position, ret.data.info.current_position || '');
                                    companyStr += (ret.data.info.current_position || '') + ' '
                                } else {
                                    companyStr += (retDetail.data.info.current_position || '') + ' '
                                    // $api.text(current_position, retDetail.data.info.current_position || '');
                                }
                                // 当前学历
                                if (ret.data.info.current_degree) {
                                    companyStr += (ret.data.info.current_degree || '') + ' '
                                    // $api.text(current_degree, ret.data.info.current_degree || '');
                                } else {
                                    companyStr += (retDetail.data.info.current_degree || '') + ' '
                                    // $api.text(current_degree, retDetail.data.info.current_degree || '');
                                }
                                $api.text(current_company, companyStr);
                                // 家乡
                                if (ret.data.info.hometown) {
                                    $api.text(hometown, ret.data.info.hometown || '');
                                } else {
                                    $api.text(hometown, retDetail.data.info.hometown || '');
                                }

                                // 电话
                                if (ret.data.info.current_contact) {
                                    // // console.log('11111111')
                                    $api.text(phone, ret.data.info.current_contact);
                                } else {
                                    // // console.log('22222222')
                                    $api.text(phone, retDetail.data.info.current_contact);
                                }

                               //  当前状态
                                if (ret.data.status.length > 0) {
                                    getData(ret.data.status)
                                } else {
                                    getData(retDetail.data.status)
                                }
                                // 生日
                                if (ret.data.info.birthday) {
                                    $api.text(birthday, ret.data.info.birthday == '0000-00-00' ? '' : ret.data.info.birthday);
                                } else {
                                    $api.text(birthday, retDetail.data.info.birthday == '0000-00-00' ? '' : retDetail.data.info.birthday);
                                }
                            } else {
                                // 有本地信息 对比信息

                                paramRealName = retDetail.data.info.real_name;
                                //  当前状态
                                if (retDetail.data.status.length > 0) {
                                    getData(retDetail.data.status);
                                    var statueStr = ''
                                    statueStr = (retDetail.data.info.current_position || '') +' '+ (retDetail.data.info.current_company || '') +' '+ (retDetail.data.info.current_degree || '')
                                    // $api.text(current_position, retDetail.data.info.current_position || '');
                                    // $api.text(current_position, retDetail.data.info.current_position || '');
                                    $api.text(current_company, statueStr);
                                    // $api.text(current_degree, retDetail.data.info.current_degree || '');
                                }
                                // 本地数据库有信息, 只获取关系
                                relationship(retDetail.data.relationship_level,retDetail.data.info.status);
                                  // 真实姓名
                                if (ret.data.info.real_name) {
                                    paramRealName = ret.data.info.real_name;
                                } else {
                                    paramRealName = retDetail.data.info.real_name;
                                }
                                // 昵称
                                if (ret.data.info.nickname) {
                                    $api.text(nickname, ret.data.info.nickname);
                                } else {
                                    $api.text(nickname, retDetail.data.info.nickname);
                                }

                                // 头像
                                if (ret.data.info.head_img_url) {
                                    $api.attr(head_img_url, 'src', ret.data.info.head_img_url);
                                } else {
                                    $api.attr(head_img_url, 'src', retDetail.data.info.head_img_url);
                                }
                                // 性别
                                if (ret.data.info.sex) {
                                    if (ret.data.info.sex == 2) {
                                        $api.addCls(sex, 'sexIcon2');
                                    }
                                } else {
                                    if (retDetail.data.info.sex == 2) {
                                        $api.addCls(sex, 'sexIcon2');
                                    }
                                }
                                var companyStr ='';
                                 // 当前公司
                                if (ret.data.info.current_company) {
                                    companyStr += (ret.data.info.current_company || '') + ' '
                                    // $api.text(current_company, ret.data.info.current_company || '');
                                } else {
                                    companyStr += (retDetail.data.info.current_company || '') + ' '
                                    // $api.text(current_company, retDetail.data.info.current_company || '');
                                }
                                // 当前职位
                                if (ret.data.info.current_position) {
                                    // $api.text(current_position, ret.data.info.current_position || '');
                                    companyStr += (ret.data.info.current_position || '') + ' '
                                } else {
                                    companyStr += (retDetail.data.info.current_position || '') + ' '
                                    // $api.text(current_position, retDetail.data.info.current_position || '');
                                }
                                // 当前学历
                                if (ret.data.info.current_degree) {
                                    companyStr += (ret.data.info.current_degree || '') + ' '
                                    // $api.text(current_degree, ret.data.info.current_degree || '');
                                } else {
                                    companyStr += (retDetail.data.info.current_degree || '') + ' '
                                    // $api.text(current_degree, retDetail.data.info.current_degree || '');
                                }
                                $api.text(current_company, companyStr);
                                // 家乡
                                if (ret.data.info.hometown) {
                                    $api.text(hometown, ret.data.info.hometown || '');
                                } else {
                                    $api.text(hometown, retDetail.data.info.hometown || '');
                                }

                                // 电话
                                if (ret.data.info.current_contact) {
                                    $api.text(phone, ret.data.info.current_contact);
                                } else {
                                    $api.text(phone, retDetail.data.info.current_contact);
                                }

                               //  当前状态
                                if (ret.data.status.length > 0) {
                                    getData(ret.data.status)
                                } else {
                                    getData(retDetail.data.status)
                                }
                                // 生日
                                if (ret.data.info.birthday) {
                                    $api.text(birthday, ret.data.info.birthday == '0000-00-00' ? '' : ret.data.info.birthday);
                                } else {
                                    $api.text(birthday, retDetail.data.info.birthday == '0000-00-00' ? '' : retDetail.data.info.birthday);
                                }
                            }
                        } else {
                            alert(JSON.stringify(errDetail))
                        }
                    })


                }
            } else {
                alert(JSON.stringify(err))
            }
        })
    }
    // 对比信息
    function infoComparison(obj1, obj2) {
        for (key1 in obj1) {
            for (key2 in obj2) {
                if (obj1[key1] == null) {
                    obj1[key1] = ''
                }
                if (obj2[key2] == null) {
                    obj2[key2] = ''
                }
                if (key1 === key2) {
                    if (!(obj1[key1] == obj2[key2])) {
                        // 更新本地库
                        updateSql(key1, obj2[key2])
                    }
                }
            }
        }
    }
    function infoComparison2(remarkInfo,obj) {
        // // // console.log('网络信息'+JSON.stringify(obj))
        db.selectSql({
            name: 'db_' + $api.getStorage('userToken'),
            sql: 'SELECT * FROM addressList_simplify WHERE user_id = ' + api.pageParam.userId
        }, function(ret, err){
            if( ret.status ){
                // 网络信息 obj
                // 备注信息 remarkInfo
                // 本地信息 ret
                // console.log('本地信息'+JSON.stringify( ret ) );
                if (ret.data.length != 0) {
                    if (!remarkInfo.nickname) {
                        if (obj.nickname != ret.data[0].title) {
                            updateListSql('title', obj.nickname);
                            // // console.log('nickname')
                        }
                    }
                    if (!remarkInfo.head_img_url) {
                        if (obj.head_img_url != ret.data[0].img) {
                            updateListSql('img', obj.head_img_url);
                        }
                    }
                    var subTitle = obj.current_company+' '+obj.current_position+' '+obj.current_degree+' ';
                    if (!remarkInfo.current_company || !remarkInfo.current_position || !remarkInfo.current_degree) {
                        if ($api.trimAll(subTitle) != $api.trimAll(ret.data[0].subTitle)) {
                            updateListSql('subTitle', subTitle)
                            // // console.log('subTitle' + subTitle)
                        }
                    }
                    if (!remarkInfo.current_contact) {
                        if (obj.current_contact != ret.data[0].current_contact) {
                            updateListSql('current_contact', obj.current_contact)
                            // // console.log('current_contact')
                        }
                    }
                }
            }else{
                alert( JSON.stringify( err ) );
            }
        });

        //
        // obj.head_img_url
        // obj.current_company
        // obj.current_position
        // obj.current_degree
        // obj.current_contact
    }
    // 更新列表数据库
    function updateListSql(key, data) {
        db.executeSql({
            name: 'db_' + $api.getStorage('userToken'),
            sql: ' UPDATE addressList_simplify SET ' + key + '= "' + data + '" WHERE user_id = ' + api.pageParam.userId
        }, function(ret, err){
            if( ret.status ){
                console.log('发送时间')
               api.sendEvent({
                   name: 'editUserInfo',
                   extra: {
                       flag: api.pageParam.flag
                   }
               });
            }else{
                createSimplify(key, data);
            }
        });
    }
    function createSimplify(key, data) {
        db.executeSql({
            name: 'db_'+$api.getStorage('userToken'),
            sql: 'ALTER TABLE addressList_simplify ADD current_contact varchar(255)'
        }, function(ret, err){
            if( ret.status ){
                updateListSql(key, data);
            }else{
                // alert( JSON.stringify( err ) );
            }
        });
    }
    // 更新数据库
    function updateSql(key, data) {
        db.executeSql({
            name: 'db_' + $api.getStorage('userToken'),
            sql: ' UPDATE addressList SET ' + key + '= "' + data + '" WHERE user_id = ' + api.pageParam.userId
        }, function(ret, err){
            if( ret.status ){
                console.log('992')
                initPage();
            }else{
                alert( JSON.stringify( err ) );
            }
        });
    }
    // 电话
    function requireContact() {
        var phone = $api.byId('phone');
        api.ajax({
            url: apiSite + '/user/contactList',
            method: 'post',
            headers: apiHeader,
            data: {
                   values: {
                       token: $api.getStorage('userToken'),
                       user_id: api.pageParam.userId
                   }
            }
        }, function(ret, err) {
            if(ret) {
                // // // console.log('用户自己的'+JSON.stringify(ret.data.list));
                for (var i = 0; i < ret.data.list.length; i++) {
                    if (ret.data.list[i].is_default == 1) {
                        $api.text(phone, ret.data.list[i].phone || '');
                        $api.attr(phone, 'data-id', ret.data.list[i].contact_id || '');
                    }
                }
            } else {
                alert('701'+JSON.stringify(err))
            }
        });
    }
    // 当前状态
    function initStatus() {
        db.selectSql({
            name: SQLName,
            sql: 'SELECT * FROM tb_remarks_status WHERE remark_user_id = ' + api.pageParam.userId
        }, function(ret, err){
            if( ret.status ){
                // // // console.log( '626::::' + JSON.stringify( ret ) );
                if (ret.data.length != 0) {
                    // // // console.log('本地数据库')
                    for (var i = 0; i < ret.data.length; i++) {
                        if (ret.data[i].type == 2) {
                            // 學習
                            // // // console.log(ret.data[i].degree)
                            switch(ret.data[i].degree) {
                                case '0': ret.data[i].degree = ''; break;
                                case '1': ret.data[i].degree = '专科'; break;
                                case '2': ret.data[i].degree = '本科'; break;
                                case '3': ret.data[i].degree = '硕士'; break;
                                case '4': ret.data[i].degree = '博士'; break;
                                case '5': ret.data[i].degree = '博士后'; break;
                            }
                        }

                    }
                    // // // console.log('本地数据库tb_remarks_status内容')
                    reviseText(ret.data);
                    getData(ret.data);
                    statusRemarks(ret.data,1)
                } else {
                    // // // console.log('获取网络信息')
                    statusRemarks();
                }
            }else{
                statusRemarks();
                // alert( '629'+JSON.stringify( err ) );
                // // // console.log( '629'+JSON.stringify( err ) );

            }
        });
    }
    // 修改昵称下面的显示
    function reviseText(data) {
        // 当前动态
        var current_company = $api.byId('current_company');
        var current_position = $api.byId('current_position');
        var current_degree = $api.byId('current_degree');
        if (data) {
            for (var i = 0; i < data.length; i++) {
                if (data[i].is_default == 1) {
                    $api.text(current_company, data[i].name+' '+data[i].position+' '+data[i].degree);

                    // if (data[i].type == 2) {
                    //     $api.text(current_company, data[i].name);
                    //     $api.text(current_position, data[i].position);
                    //     $api.text(current_degree, data[i].degree);
                    // } else {
                    //     $api.text(current_company, data[i].name);
                    //     $api.text(current_position, data[i].position);
                    //     $api.text(current_degree, '');
                    // }
                }
            }
        } else {
            $api.text(current_company, '');
            // $api.text(current_position, '');
            // $api.text(current_degree, '');
        }
    }
    // 当前状态 - 备注信息
    function statusRemarks(data,argument) {
        api.ajax({
            url: apiSite + '/remark_user/fullInfo',
            method: 'post',
            headers: apiHeader,
            data: {
                   values: {
                       token: $api.getStorage('userToken'),
                       remark_user_id: api.pageParam.userId,
                   }
            }
        }, function(ret, err) {
            if(ret) {
                if (!argument) {
                    if (ret.data.status.length != 0) {
                        handData(ret)
                    } else {
                        statusUser();
                    }
                } else {
                    console.log('对比')
                    // 对比
                    if (data.length != ret.data.status.length) {
                        // 更新数据库
                        handData(ret)
                        console.log('更新数据库')
                    }
                }
            } else {
                alert(JSON.stringify(err))
            }
        })
    }
    // 当前状态 - 原始信息
    function statusUser() {
        api.ajax({
            url: apiSite + '/user/detail',
            method: 'post',
            headers: apiHeader,
            data: {
                values: {
                    token: $api.getStorage('userToken'),
                    user_id: api.pageParam.userId
                }
            }
        }, function (ret, err) {
            if (ret) {
                if (ret.data.status.length != 0) {
                    // // // console.log('原始信息')
                }
                    handData(ret)
            }
        })
    }

    function handData(ret) {
        console.log('707:::'+JSON.stringify(ret))
        if (ret.data.status != '') {
            var sql = 'INSERT OR REPLACE INTO tb_remarks_status(remark_user_id, status_id, name, position, degree, start_date, is_default, type) VALUES ';
            for (var i = 0; i < ret.data.status.length; i++) {
                sql +=  '(' + api.pageParam.userId + ',' + ret.data.status[i].status_id + ',"' + ret.data.status[i].name+ '","' + ret.data.status[i].position+ '","' + ret.data.status[i].degree+ '","' + ret.data.status[i].start_date+ '",' + ret.data.status[i].is_default+ ',' + ret.data.status[i].type + '),';
                if (ret.data.status[i].type == 2) {
                    // 學習
                    // // // console.log(ret.data.status[i].degree)
                    switch(ret.data.status[i].degree) {
                        case '0': ret.data.status[i].degree = ''; break;
                        case '1': ret.data.status[i].degree = '专科'; break;
                        case '2': ret.data.status[i].degree = '本科'; break;
                        case '3': ret.data.status[i].degree = '硕士'; break;
                        case '4': ret.data.status[i].degree = '博士'; break;
                        case '5': ret.data.status[i].degree = '博士后'; break;
                    }
                }
            }
            sql = sql.substring(0,sql.length-1);
            // // // console.log(sql)
            db.executeSql({
                name: 'db_' + $api.getStorage('userToken'),
                sql: sql
            }, function(retSql, errSql){
                if( retSql.status ){
                    reviseText(ret.data.status)
                    getData(ret.data.status)
                }else{
                    alert( JSON.stringify( errSql ) );
                }
            });
        } else {
            reviseText()
            getData()
        }
    }
    // 初始化页面
    function initPage() {
        // // // console.log('重新请求数据')
        var nickname = $api.byId('nickname');
        var sex = $api.byId('sex');
        var head_img_url = $api.byId('head_img_url');
        var phone = $api.byId('phone');
        var hometown = $api.byId('hometown');
        var birthday = $api.byId('birthday');
        // var current_company = $api.byId('current_company');
        // var current_position = $api.byId('current_position');
        // var current_degree = $api.byId('current_degree');
        var relationship_level = $api.byId('relationship_level');
        var liRightIcon = $api.byId('liRightIcon');
        /**
         * 优先本地数据库数据
         * 其次线上备注内容
         * 最后用户原始信息
         *
         * 昵称 - 性别 - 头像 - 家乡 - 生日 - 当前公司 - 当前职位 === 数据库表名 tb_remarks_user_info
         * 电话 === tb_remarks_contact
         */
        var SQLName = 'db_' + $api.getStorage('userToken');
        db.selectSql({
            name: SQLName,
            sql: 'SELECT * FROM addressList WHERE user_id = ' + api.pageParam.userId
        }, function (ret, err) {
            if (ret.status) {
               if (ret.data.length != 0) {
                    // // // console.log('数据库:::'+JSON.stringify(ret))
                    // 电话
                    if (ret.data[0].remark_current_contact) {
                        $api.text(phone, ret.data[0].remark_current_contact);
                    } else {
                        $api.text(phone, ret.data[0].current_contact);
                    }
                    // 生日
                    if (ret.data[0].remark_birthday) {
                        $api.text(birthday, ret.data[0].remark_birthday);
                    } else {
                        $api.text(birthday, ret.data[0].birthday);
                    }
                    // 家乡
                    if (ret.data[0].remark_hometown) {
                        $api.text(hometown, ret.data[0].remark_hometown);
                    } else {
                        $api.text(hometown, ret.data[0].hometown);
                    }
                    // 昵称
                    if (ret.data[0].remark_nickname) {
                        $api.text(nickname, ret.data[0].remark_nickname);

                    } else {
                        $api.text(nickname, ret.data[0].nickname);
                    }
                    // 头像
                    if (ret.data[0].remark_head_img_url) {
                        $api.attr(head_img_url, 'src', ret.data[0].remark_head_img_url);
                    } else {
                        $api.attr(head_img_url, 'src', ret.data[0].head_img_url);
                    }
                    // 性别
                    if (ret.data[0].remark_sex) {
                        if (ret.data[0].remark_sex == 2) {
                            $api.addCls(sex, 'sexIcon2');
                        } else {
                            $api.removeCls(sex, 'sexIcon2');
                        }
                    } else {
                        if (ret.data[0].sex == 2) {
                            $api.addCls(sex, 'sexIcon2');
                        } else {
                            $api.removeCls(sex, 'sexIcon2');
                        }
                    }
                    // 电话
                    if (ret.data[0].remark_current_contact) {
                        $api.text(phone, ret.data[0].remark_current_contact);
                    } else if (ret.data[0].current_contact) {
                        $api.text(phone, ret.data[0].current_contact);
                    } else {
                        requireContact();
                    }
                    requireData(0,ret.data[0]);
                } else {
                    // 获取线上
                    requireData(1);
                }
            } else {
                requireData(1);
            }
        });
        db.selectSql({
            name: SQLName,
            sql: 'SELECT * FROM tb_remarks_user_info WHERE remark_user_id = ' + api.pageParam.userId
        }, function(ret, err){
            if( ret.status ){
                // // // console.log('902'+JSON.stringify(ret.data))
                if (ret.data.length != 0) {
                    if (ret.data[0].extra_image_url) {
                        $api.css(liRightIcon, 'background: url('+ ret.data[0].extra_image_url +'?imageView2/3/w/200/h/200/q/75|imageslim);-webkit-background-size: .749rem auto;background-size: .749rem auto;background-position: 0 center;');
                    }
                }
            }else{
                // alert( '968:'+JSON.stringify( err ) );
            }
        });
    }

    function relationship(relationship_levelType,status) {
        var btn = $api.byId('btn');
        if(status == 1) {
            // 1 已加入
            // 其他 未加入平台
            $api.css($api.byId('btn'), 'display: block');
            sweitchData1(relationship_levelType, status)
            // $api.text(btn, '加为好友');
        } else {
            sweitchData(relationship_levelType, status)

        }
    }
    function sweitchData1(relationship_levelType, status) {
        var btn = $api.byId('btn');
        switch (relationship_levelType) {
            case 1:
                $api.text(relationship_level, '自己');
                $api.css(btn, 'display: none');
                for (var i = 0; i < $api.domAll('ul li .icon').length; i++) {
                    $api.css($api.domAll('ul li .icon')[i], 'display: none');
                }
                $api.css($api.dom('.title .icon'), 'display: none');
                $api.css($api.dom('.shadow'), 'display:block');
                // 右上角三个点
                api.sendEvent({
                    name: 'oneselfPage'
                });
                break;
            case 2:
                $api.text(relationship_level, '一度人脉熟识好友');
                break;
            case 3:
                // if(status == 1) {
                    $api.text(relationship_level, '一度人脉相识好友');
                // } else {
                    // $api.css($api.byId('btn'), 'display: none');
                    // $api.text(relationship_level, '一度人脉尚未加入');
                // }
                // 1 相识
                // -1 一度人脉尚未加入
                break;
            case 4:
                $api.text(relationship_level, '初识好友');
                break;
            case 5:
                $api.text(relationship_level, '二度人脉' + compareRelation(status));
                break;
            case 6:
                $api.text(relationship_level, '三度人脉' + compareRelation(status));
                break;
            case 7:
                $api.text(relationship_level, '四度人脉' + compareRelation(status));
                break;
            case 8:
                $api.text(relationship_level, '五度人脉' + compareRelation(status));
                break;
            case 9:
                $api.text(relationship_level, '六度人脉' + compareRelation(status));
                break;
            case 10:
                // $api.text(relationship_level, '无任何关系');
                // if(status == 1) {
                    // $api.css($api.byId('btn'), 'display: none');
                    $api.text(btn, '加为好友');

                    $api.text(relationship_level, '无任何关系');
                // } else {
                //     $api.css($api.byId('btn'), 'display: none');
                //     $api.text(relationship_level, '无任何关系');
                // }
                break;
        }
    }
    function sweitchData(relationship_levelType, status) {
        var btn = $api.byId('btn');
        $api.css($api.byId('btn'), 'display: none');
        switch (relationship_levelType) {
            case 1:
                $api.text(relationship_level, '自己');
                $api.css(btn, 'display: none');
                for (var i = 0; i < $api.domAll('ul li .icon').length; i++) {
                    $api.css($api.domAll('ul li .icon')[i], 'display: none');
                }
                $api.css($api.dom('.title .icon'), 'display: none');
                $api.css($api.dom('.shadow'), 'display:block');
                // 右上角三个点
                api.sendEvent({
                    name: 'oneselfPage'
                });
                break;
            case 2:
                $api.text(relationship_level, '一度人脉熟识好友');
                break;
            case 3:

                    $api.text(relationship_level, '一度人脉尚未加入');
                // 1 相识
                // -1 一度人脉尚未加入
                break;
            case 4:
                $api.text(relationship_level, '初识好友');
                break;
            case 5:
                $api.text(relationship_level, '二度人脉' + compareRelation(status));
                break;
            case 6:
                $api.text(relationship_level, '三度人脉' + compareRelation(status));
                break;
            case 7:
                $api.text(relationship_level, '四度人脉' + compareRelation(status));
                break;
            case 8:
                $api.text(relationship_level, '五度人脉' + compareRelation(status));
                break;
            case 9:
                $api.text(relationship_level, '六度人脉' + compareRelation(status));
                break;
            case 10:
                $api.text($api.byId('btn'), '加为好友');
                // $api.css($api.byId('btn'), 'display: none');
                $api.text(relationship_level, '无任何关系');
                break;
        }
    }
    function compareRelation(status) {
        if(status == 1) {
            return ''
        } else {
            $api.css($api.byId('btn'), 'display: none');
            return '尚未加入'
        }
    }
    function addFriends(ele) {
        var nickname = $api.text($api.byId('nickname'));
        var val = $api.text(ele)
        if (val == '发送消息') {
            // 打开聊天
            api.openWin({
                name: 'chatPage',
                url: '../news/chatPage.html',
                pageParam: {
                    targetRongId: targetRongId,
                    nickname: nickname,
                    headImg: $api.attr(head_img_url, 'src'),
                    userId: api.pageParam.userId
                }
            });
        } else {
            api.openWin({
                name: 'txl_addFriendsInfo',
                url: './txl_addFriendsInfo.html',
                bounces: false,
                pageParam: {
                    userId: api.pageParam.userId
                }
            });
        }
    }
    function openInfo(ele) {
        var nickname = $api.byId('nickname');
        var sex = $api.byId('sex');
        var head_img_url = $api.byId('head_img_url');
        paramSex = $api.hasCls(sex, 'sexIcon2') ? '女' : '男';
        paramNickname = $api.text(nickname);
        paramHeadImg = $api.attr(head_img_url, 'src');
        var val = $api.attr(ele, 'data-val');
        api.openWin({
            name: 'txl_addFellow_' + val + '_win.html',
            url: './txl_addFellow_' + val + '_win.html',
            // url: './txl_addFellow_address_win.html',
            pageParam: {
                userId: api.pageParam.userId,
                paramNickname: paramNickname,
                paramRealName: paramRealName,
                paramSex: paramSex,
                paramHeadImg: paramHeadImg,
                flag: api.pageParam.flag
            },
            bounces: false
        });
    }
    // 打开选择器
    function selectList() {
        var _dataSource2 = [], _dataSource = [], col = 1;
        var active = [];
        var selText = $api.text($api.byId('hometown'));
        col = 2;
        _dataSource = city;
        var selText1 = selText.split('-')
        active = [];
        for (var i = 0; i < _dataSource.length; i++) {
            if (_dataSource[i].name == selText1[0]) {
                active.push(i);
                for (var j = 0; j < _dataSource[i].sub.length; j++) {
                    if (_dataSource[i].sub[j].name == selText1[1]) {
                        active.push(j);
                        break;
                    }
                }
                break;
            }
        }
        var fontsize = 16, rowLength = 5;
        if (api.systemType === 'ios') {
            fontsize = 20;
            rowLength = 7;
        }
        UIActionSelector.open({
            datas: _dataSource,
            actives: active,
            layout: {
                row: rowLength,
                col: col,
                height: 30,
                size: fontsize,
                sizeActive: fontsize + 2,
                rowSpacing: 5,
                colSpacing: 5,
                maskBg: 'rgba(0,0,0,0.5)',
                bg: '#fff',
                color: '#888',
                colorSelected: '#000'
            },
            animation: true,
            cancel: {
                text: '取消',
                size: 16,
                w: 60,
                h: 40,
                bg: '#eee',
                // bgActive: '#ccc',
                color: '#000',
                // colorActive: '#fff'
            },
            ok: {
                text: '完成',
                size: 16,
                w: 60,
                h: 40,
                bg: '#eee',
                // bgActive: '#ccc',
                color: '#000',
                // colorActive: '#fff'
            },
            title: {
                text: '请选择',
                size: 20,
                h: 40,
                bg: '#F0F0F0',
                color: '#000'
            },
            fixedOn: api.frameName
        }, function (ret, err) {
            if (ret) {
                if (ret.eventType == 'ok') {
                    $api.text($api.byId('hometown'), ret.level1 + '-' + ret.level2);
                    submitData(ret.level1 + '-' + ret.level2, 1)
                }
            } else {
                alert(JSON.stringify(err.msg));
            }
        });
    }
    // 打开时间选择器
    function openTime() {
        var date, date1, date2;
        var current = $api.text($api.byId('birthday'));
        if (current != '请选择') {
            current = current.split('-')
            date = current[0];
            date1 = current[1];
            date2 = current[2];
            // // // console.log(current)
        } else {
            date = new Date().getFullYear();
            date1 = new Date().getMonth();
            date2 = new Date().getDate();
        }
        api.openPicker({
            type: 'date',
            date: date + '-' + date1 + '-' + date2,
            title: '选择生日'
        }, function (ret, err) {
            if (ret) {
                $api.text($api.byId('birthday'), ret.year + '-' + ret.month + '-' + ret.day);
                submitData(ret.year + '-' + ret.month + '-' + ret.day, 0)
            } else {
                alert(JSON.stringify(err.msg));
            }
        });
    }
    function submitData(data, flag) {
        var obj = {};
        if (flag) {
            obj = {
                token: $api.getStorage('userToken'),
                remark_user_id: api.pageParam.userId,
                hometown: data,
            }
        } else {
            obj = {
                token: $api.getStorage('userToken'),
                remark_user_id: api.pageParam.userId,
                birthday: data
            }
        }
        // // // console.log(JSON.stringify(data))
        api.ajax({
            url: apiSite + '/remark_user/editBasicInfo',
            method: 'post',
            headers: apiHeader,
            data: {
                values: obj
            }
        }, function (ret, err) {
            if (ret) {
                if (ret.code === 200) {
                    // // // console.log('663:' + JSON.stringify(ret))
                    if (relationship_level_flag == 2 || relationship_level_flag == 3 || relationship_level_flag == 4) {
                        api.ajax({
                            url: apiSite + '/remark_user/fullInfo',
                            method: 'post',
                            headers: apiHeader,
                            data: {
                                values: {
                                    token: $api.getStorage('userToken'),
                                    remark_user_id: api.pageParam.userId
                                }
                            }
                        }, function (ret, err) {
                            if (ret) {
                                var SQL = 'INSERT OR REPLACE INTO addressList(user_id, remark_birthday, remark_hometown) VALUES (' + api.pageParam.userId + ',"' + ret.data.info.birthday + '","' + ret.data.info.hometown + '")'
                                db.selectSql({
                                    name: 'db_' + $api.getStorage('userToken'),
                                    sql: 'SELECT * FROM addressList WHERE user_id=' + api.pageParam.userId
                                }, function (retSql, err1) {
                                    if (retSql.status) {
                                        if (retSql.data.length !== 0) {
                                            // // // console.log('有数据,更新')
                                            // 有数据 更新
                                            db.executeSql({
                                                name: 'db_' + $api.getStorage('userToken'),
                                                sql: 'UPDATE addressList SET remark_birthday = "' + ret.data.info.birthday + '", remark_hometown = "' + ret.data.info.hometown + '" WHERE user_id = ' + api.pageParam.userId
                                            }, function (ret, err) {
                                                if (ret.status) {
                                                    // // // console.log('688:' + JSON.stringify(ret));
                                                } else {
                                                    alert('690:' + JSON.stringify(err));
                                                }
                                            });
                                        } else {
                                            // // // console.log('没有数据,插入')
                                            // 没数据 插入新数据
                                            db.executeSql({
                                                name: 'db_' + $api.getStorage('userToken'),
                                                sql: SQL
                                            }, function (ret, err) {
                                                if (ret.status) {
                                                    // // // console.log('684:::' + JSON.stringify(ret));
                                                } else {
                                                    alert(JSON.stringify(err));
                                                }
                                            });
                                        }
                                    } else {
                                        alert(JSON.stringify(err))
                                    }
                                })
                            } else {
                                alert(ret.msg)
                            }
                        })
                    }
                } else {
                    alert(ret.msg)
                }
            } else {
                alert(JSON.stringify(err))
            }
        })
    }
</script>
</html>